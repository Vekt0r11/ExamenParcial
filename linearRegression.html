<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
    <title>Document</title>
</head>

<body>

    <script>
        async function start() {

            //Instanciamos nuestro modelo secuencial
            const model = tf.sequential();

            //Creamos nuestra primer capa
            const hiddenLayer = tf.layers.dense({
                units: 2,
                inputShape: [1],
                // activation: 'relu'
            });
            //Agregamos la capa al modelo
            model.add(hiddenLayer);


            //Creamos una segunda capa
            // const hiddenLayer2 = tf.layers.dense({
            //     units: 1,
            //     activation: 'relu'
            // });
            // model.add(hiddenLayer2);


            //Creamos la capa de salida
            const output = tf.layers.dense({
                units: 1,
                // activation: 'relu'
            });
            //Agregamos la capa de salida a nuestro modelo
            model.add(output);


            //Compilamos nuestro modelo con un optimizador y una función de pérdida
            model.compile({
                optimizer: "sgd",
                loss: "meanSquaredError",
                metrics: ['accuracy']
            });

            //Declaramos nuestros tensores de entrenamiento
            const x = tf.tensor2d([
                [0],
                [4],
                [8]
            ]);
            const y = tf.tensor2d([
                [3],
                [7],
                [11]
            ]);


            //Declaramos la superficie de nuestra vista
            const surface = {
                name: 'Pérdida'
            };

            //Opciones para el entrenamieno
            const options = {
                shuffle: true,
                epochs: 150,
                callbacks: tfvis.show.fitCallbacks(surface, ['loss', 'acc'])
            }

            //Entrenamos nuestro modelo
            const respuesta = await model.fit(x, y, options);

            //Mostramos el grafico de pérdida
            // tfvis.show.history(surface, respuesta, ['loss']);

            return model
        }

        //Luego haremos nuestra predicción con nuevos datos de entrada
        start().then((model) => {

            //Nuevos datos de entrada
            const entrada = tf.tensor2d([
                [0],
                [5],
                [11]
            ]);

            //Predicción
            const salida = model.predict(entrada);  
            salida.print();

        });
    </script>
    <!-- <script src="/parcial/scripts.js"></script> -->

</body>

</html>